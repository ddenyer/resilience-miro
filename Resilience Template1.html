<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px '.AppleSystemUIFontMonospaced'; color: #870581}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px '.AppleSystemUIFontMonospaced'; color: #97007e}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px '.AppleSystemUIFontMonospaced'; color: #000000}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px '.AppleSystemUIFontMonospaced'; color: #b50013}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px '.AppleSystemUIFontMonospaced'; color: #0d6401}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px '.AppleSystemUIFontMonospaced'; color: #000000; min-height: 16.0px}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px '.AppleSystemUIFontMonospaced'; color: #6f5a1e}
    span.s1 {color: #97007e}
    span.s2 {color: #000000}
    span.s3 {color: #6f5a1e}
    span.s4 {color: #b50013}
    span.s5 {color: #1400c4}
    span.s6 {color: #885d30}
    span.s7 {color: #0d6401}
  </style>
</head>
<body>
<p class="p1">&lt;!doctype <span class="s1">html</span>&gt;</p>
<p class="p2">&lt;html&gt;</p>
<p class="p2"><span class="s2"><span class="Apple-converted-space">  </span></span>&lt;head&gt;</p>
<p class="p2"><span class="s2"><span class="Apple-converted-space">    </span></span>&lt;meta <span class="s3">charset</span>=<span class="s4">"utf-8"</span> /&gt;</p>
<p class="p3"><span class="Apple-converted-space">    </span><span class="s1">&lt;title&gt;</span>Resilience by Design™ – Miro Builder<span class="s1">&lt;/title&gt;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;meta </span><span class="s3">name</span><span class="s1">=</span>"viewport"<span class="s1"> </span><span class="s3">content</span><span class="s1">=</span>"width=device-width, initial-scale=1"<span class="s1"> /&gt;</span></p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">    </span></span>&lt;!-- Miro Web SDK v2 --&gt;</p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;script </span><span class="s3">src</span><span class="s1">=</span>"https://miro.com/app/static/sdk/v2/miro.js"<span class="s1">&gt;&lt;/script&gt;</span></p>
<p class="p2"><span class="s2"><span class="Apple-converted-space">    </span></span>&lt;style&gt;</p>
<p class="p3"><span class="Apple-converted-space">      </span><span class="s1">body</span> { <span class="s1">font-family</span>: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; <span class="s1">margin</span>: <span class="s5">0</span>; <span class="s1">padding</span>: <span class="s5">16px</span>; }</p>
<p class="p3"><span class="Apple-converted-space">      </span><span class="s6">.wrap</span> { <span class="s1">display</span>: flex; <span class="s1">gap</span>: <span class="s5">12px</span>; <span class="s1">align-items</span>: center; }</p>
<p class="p2"><span class="s2"><span class="Apple-converted-space">      </span></span>button<span class="s2"> { </span>padding<span class="s2">: </span><span class="s5">10px</span><span class="s2"> </span><span class="s5">14px</span><span class="s2">; </span>border<span class="s2">: </span><span class="s5">0</span><span class="s2">; </span>border-radius<span class="s2">: </span><span class="s5">10px</span><span class="s2">; </span>cursor<span class="s2">: pointer; }</span></p>
<p class="p3"><span class="Apple-converted-space">      </span><span class="s6">.primary</span> { <span class="s1">background</span>:<span class="s5">#2b6be4</span>; <span class="s1">color</span>:white; }</p>
<p class="p3"><span class="Apple-converted-space">      </span><span class="s6">.ghost</span> { <span class="s1">background</span>:<span class="s5">#f3f4f6</span>; <span class="s1">color</span>:<span class="s5">#111827</span>; }</p>
<p class="p3"><span class="Apple-converted-space">      </span>small { <span class="s1">color</span>:<span class="s5">#6b7280</span>; }</p>
<p class="p2"><span class="s2"><span class="Apple-converted-space">    </span></span>&lt;/style&gt;</p>
<p class="p2"><span class="s2"><span class="Apple-converted-space">  </span></span>&lt;/head&gt;</p>
<p class="p2"><span class="s2"><span class="Apple-converted-space">  </span></span>&lt;body&gt;</p>
<p class="p2"><span class="s2"><span class="Apple-converted-space">    </span></span>&lt;div <span class="s3">class</span>=<span class="s4">"wrap"</span>&gt;</p>
<p class="p3"><span class="Apple-converted-space">      </span><span class="s1">&lt;button </span><span class="s3">class</span><span class="s1">=</span><span class="s4">"primary"</span><span class="s1"> </span><span class="s3">id</span><span class="s1">=</span><span class="s4">"build"</span><span class="s1">&gt;</span>Build Resilience Architecture<span class="s1">&lt;/button&gt;</span></p>
<p class="p3"><span class="Apple-converted-space">      </span><span class="s1">&lt;button </span><span class="s3">class</span><span class="s1">=</span><span class="s4">"ghost"</span><span class="s1"> </span><span class="s3">id</span><span class="s1">=</span><span class="s4">"clean"</span><span class="s1">&gt;</span>Select &amp; group outputs<span class="s1">&lt;/button&gt;</span></p>
<p class="p2"><span class="s2"><span class="Apple-converted-space">    </span></span>&lt;/div&gt;</p>
<p class="p3"><span class="Apple-converted-space">    </span><span class="s1">&lt;small&gt;</span>Creates five frames (Environment, VSM, PACE2, Swiss Cheese → Bow-Tie, Adaptive Learning) with labels and connectors.<span class="s1">&lt;/small&gt;</span></p>
<p class="p6"><br></p>
<p class="p2"><span class="s2"><span class="Apple-converted-space">    </span></span>&lt;script&gt;</p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">      </span></span>// ---- Layout constants (positions in pixels on the infinite canvas)</p>
<p class="p3"><span class="Apple-converted-space">      </span><span class="s1">const</span> ORIGIN_Y = <span class="s5">0</span>;</p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s1">const</span><span class="s2"> GAP_X = </span><span class="s5">1600</span><span class="s2">;<span class="Apple-converted-space">          </span></span>// horizontal spacing between frames</p>
<p class="p3"><span class="Apple-converted-space">      </span><span class="s1">const</span> FRAME_W = <span class="s5">1400</span>;</p>
<p class="p3"><span class="Apple-converted-space">      </span><span class="s1">const</span> FRAME_H = <span class="s5">900</span>;</p>
<p class="p6"><br></p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">      </span></span>// Colours (hex) for quick recognition</p>
<p class="p3"><span class="Apple-converted-space">      </span><span class="s1">const</span> COL = {</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s3">frameStroke</span>: <span class="s4">'#111827'</span>,</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s3">vsm</span>: <span class="s4">'#9ca3af'</span>,<span class="Apple-converted-space">          </span><span class="s7">// grey (structure)</span></p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s3">pace</span>: <span class="s4">'#10b981'</span>, <span class="Apple-converted-space">        </span><span class="s7">// green (behaviour)</span></p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s3">causal</span><span class="s2">: </span><span class="s4">'#ef4444'</span><span class="s2">, <span class="Apple-converted-space">      </span></span>// red (diagnostic/control)</p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s3">capability</span><span class="s2">: </span><span class="s4">'#3b82f6'</span><span class="s2">, <span class="Apple-converted-space">  </span></span>// blue (capabilities)</p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s3">capitals</span><span class="s2">: </span><span class="s4">'#d4a017'</span><span class="s2">, <span class="Apple-converted-space">    </span></span>// gold (resources)</p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s3">learning</span><span class="s2">: </span><span class="s4">'#7c3aed'</span><span class="s2">, <span class="Apple-converted-space">    </span></span>// purple (development)</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s3">text</span>: <span class="s4">'#111827'</span>,</p>
<p class="p3"><span class="Apple-converted-space">      </span>};</p>
<p class="p6"><br></p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">      </span></span>// Utility: create a frame with title</p>
<p class="p3"><span class="Apple-converted-space">      </span><span class="s1">async</span> <span class="s1">function</span> createFrame(x, y, title, color) {</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">return</span> <span class="s1">await</span> miro.board.createFrame({</p>
<p class="p3"><span class="Apple-converted-space">          </span>title,</p>
<p class="p3"><span class="Apple-converted-space">          </span>x, y,</p>
<p class="p3"><span class="Apple-converted-space">          </span><span class="s3">width</span>: FRAME_W,</p>
<p class="p3"><span class="Apple-converted-space">          </span><span class="s3">height</span>: FRAME_H,</p>
<p class="p3"><span class="Apple-converted-space">          </span><span class="s3">style</span>: { <span class="s3">fillColor</span>: <span class="s4">'transparent'</span>, <span class="s3">strokeColor</span>: COL.frameStroke, <span class="s3">strokeWidth</span>: <span class="s5">3</span> },</p>
<p class="p3"><span class="Apple-converted-space">        </span>});</p>
<p class="p3"><span class="Apple-converted-space">      </span>}</p>
<p class="p6"><br></p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">      </span></span>// Utility: create text</p>
<p class="p3"><span class="Apple-converted-space">      </span><span class="s1">async</span> <span class="s1">function</span> createText(content, x, y, width = <span class="s5">600</span>, color = COL.text, fontSize = <span class="s5">28</span>) {</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">return</span> <span class="s1">await</span> miro.board.createText({</p>
<p class="p3"><span class="Apple-converted-space">          </span>content,</p>
<p class="p3"><span class="Apple-converted-space">          </span>x, y,</p>
<p class="p3"><span class="Apple-converted-space">          </span>width,</p>
<p class="p3"><span class="Apple-converted-space">          </span><span class="s3">style</span>: { <span class="s3">fillColor</span>: <span class="s4">'transparent'</span>, <span class="s3">textColor</span>: color, fontSize, <span class="s3">textAlign</span>: <span class="s4">'l'</span>, <span class="s3">bold</span>: <span class="s1">false</span> },</p>
<p class="p3"><span class="Apple-converted-space">        </span>});</p>
<p class="p3"><span class="Apple-converted-space">      </span>}</p>
<p class="p6"><br></p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">      </span></span>// Utility: create a labelled shape (rounded rectangle)</p>
<p class="p3"><span class="Apple-converted-space">      </span><span class="s1">async</span> <span class="s1">function</span> createShape(label, x, y, w = <span class="s5">380</span>, h = <span class="s5">160</span>, fill = <span class="s4">'#ffffff'</span>, border = <span class="s4">'#111827'</span>, fontSize = <span class="s5">26</span>) {</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">return</span> <span class="s1">await</span> miro.board.createShape({</p>
<p class="p3"><span class="Apple-converted-space">          </span><span class="s3">content</span>: label,</p>
<p class="p3"><span class="Apple-converted-space">          </span>x, y, <span class="s3">width</span>: w, <span class="s3">height</span>: h,</p>
<p class="p3"><span class="Apple-converted-space">          </span><span class="s3">style</span>: { <span class="s3">fillColor</span>: fill, <span class="s3">strokeColor</span>: border, <span class="s3">strokeWidth</span>: <span class="s5">3</span>, <span class="s3">textColor</span>: COL.text, fontSize, <span class="s3">borderStyle</span>: <span class="s4">'normal'</span> },</p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">          </span></span><span class="s3">shape</span><span class="s2">: </span>'round_rectangle'<span class="s2">,</span></p>
<p class="p3"><span class="Apple-converted-space">        </span>});</p>
<p class="p3"><span class="Apple-converted-space">      </span>}</p>
<p class="p6"><br></p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">      </span></span>// Utility: connector</p>
<p class="p3"><span class="Apple-converted-space">      </span><span class="s1">async</span> <span class="s1">function</span> connect(src, tgt, color = COL.capability, arrows = <span class="s4">'end'</span>) {</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">return</span> <span class="s1">await</span> miro.board.createConnector({</p>
<p class="p3"><span class="Apple-converted-space">          </span><span class="s3">start</span>: { <span class="s3">item</span>: src.id, <span class="s3">position</span>: { <span class="s3">x</span>: <span class="s5">0</span>, <span class="s3">y</span>: <span class="s5">0</span> } },</p>
<p class="p3"><span class="Apple-converted-space">          </span><span class="s3">end</span>: <span class="Apple-converted-space">  </span>{ <span class="s3">item</span>: tgt.id, <span class="s3">position</span>: { <span class="s3">x</span>: <span class="s5">0</span>, <span class="s3">y</span>: <span class="s5">0</span> } },</p>
<p class="p7"><span class="s2"><span class="Apple-converted-space">          </span></span>style<span class="s2">: { </span>strokeColor<span class="s2">: color, </span>strokeWidth<span class="s2">: </span><span class="s5">4</span><span class="s2">, </span>endStrokeCap<span class="s2">: </span><span class="s4">'arrow'</span><span class="s2"> },</span></p>
<p class="p3"><span class="Apple-converted-space">        </span>});</p>
<p class="p3"><span class="Apple-converted-space">      </span>}</p>
<p class="p6"><br></p>
<p class="p3"><span class="Apple-converted-space">      </span><span class="s1">async</span> <span class="s1">function</span> build() {</p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">        </span></span>// Starting at current viewport centre</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">const</span> viewport = <span class="s1">await</span> miro.board.viewport.get();</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">const</span> startX = viewport.x + viewport.width/<span class="s5">2</span> - (FRAME_W*<span class="s5">2</span> + GAP_X*<span class="s5">2</span>)/<span class="s5">2</span>;</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">const</span> y = ORIGIN_Y + viewport.y + <span class="s5">100</span>;</p>
<p class="p6"><br></p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">        </span></span>// ---- FRAME 1: Environment &amp; System Context (5 Capitals / 5Cs)</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">const</span> f1 = <span class="s1">await</span> createFrame(startX, y, <span class="s4">'FRAME 1 – Environment &amp; System Context'</span>, COL.capitals);</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">const</span> env = <span class="s1">await</span> createShape(<span class="s4">'External Environment\n(Stressors, Policies, Market Volatility, Crises)'</span>, f1.x - FRAME_W/<span class="s5">2</span> + <span class="s5">280</span>, f1.y - <span class="s5">250</span>, <span class="s5">520</span>, <span class="s5">180</span>, <span class="s4">'#fff'</span>, COL.capitals);</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">const</span> capitals = <span class="s1">await</span> createShape(<span class="s4">'5 Capitals\n• Natural • Human • Social • Manufactured • Financial'</span>, f1.x - <span class="s5">200</span>, f1.y - <span class="s5">50</span>, <span class="s5">520</span>, <span class="s5">200</span>, <span class="s4">'#fff'</span>, COL.capitals);</p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">const</span><span class="s2"> fiveCs = </span><span class="s1">await</span><span class="s2"> createShape(</span>'5Cs Metrics Panel\nCharacteristics • Capability • Capacity • Connectivity • Consequences'<span class="s2">, f1.x + </span><span class="s5">350</span><span class="s2">, f1.y - </span><span class="s5">70</span><span class="s2">, </span><span class="s5">560</span><span class="s2">, </span><span class="s5">220</span><span class="s2">, </span>'#fff'<span class="s2">, COL.capitals);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">await</span><span class="s2"> createText(</span>'Purpose: Define boundaries, context, and inputs to resilience.'<span class="s2">, f1.x - </span><span class="s5">580</span><span class="s2">, f1.y + </span><span class="s5">250</span><span class="s2">, </span><span class="s5">1000</span><span class="s2">, COL.capitals, </span><span class="s5">22</span><span class="s2">);</span></p>
<p class="p6"><br></p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">        </span></span>// ---- FRAME 2: VSM (Structure)</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">const</span> f2 = <span class="s1">await</span> createFrame(f1.x + FRAME_W/<span class="s5">2</span> + GAP_X + FRAME_W/<span class="s5">2</span>, y, <span class="s4">'FRAME 2 – System Structure (Viable System Model, Beer)'</span>, COL.vsm);</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">const</span> s1 = <span class="s1">await</span> createShape(<span class="s4">'S1 – Operations'</span>, f2.x - <span class="s5">500</span>, f2.y - <span class="s5">120</span>, <span class="s5">360</span>, <span class="s5">140</span>, <span class="s4">'#f3f4f6'</span>, COL.vsm);</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">const</span> s2 = <span class="s1">await</span> createShape(<span class="s4">'S2 – Coordination'</span>, f2.x - <span class="s5">90</span>,<span class="Apple-converted-space">  </span>f2.y - <span class="s5">220</span>, <span class="s5">360</span>, <span class="s5">120</span>, <span class="s4">'#f3f4f6'</span>, COL.vsm);</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">const</span> s3 = <span class="s1">await</span> createShape(<span class="s4">'S3 – Control'</span>,<span class="Apple-converted-space">      </span>f2.x - <span class="s5">90</span>,<span class="Apple-converted-space">  </span>f2.y - <span class="s5">60</span>,<span class="Apple-converted-space">  </span><span class="s5">360</span>, <span class="s5">120</span>, <span class="s4">'#f3f4f6'</span>, COL.vsm);</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">const</span> s4 = <span class="s1">await</span> createShape(<span class="s4">'S4 – Intelligence'</span>, f2.x - <span class="s5">90</span>,<span class="Apple-converted-space">  </span>f2.y + <span class="s5">100</span>, <span class="s5">360</span>, <span class="s5">120</span>, <span class="s4">'#f3f4f6'</span>, COL.vsm);</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">const</span> s5 = <span class="s1">await</span> createShape(<span class="s4">'S5 – Policy'</span>, <span class="Apple-converted-space">      </span>f2.x + <span class="s5">320</span>, f2.y - <span class="s5">60</span>,<span class="Apple-converted-space">  </span><span class="s5">360</span>, <span class="s5">120</span>, <span class="s4">'#f3f4f6'</span>, COL.vsm);</p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">await</span><span class="s2"> createText(</span>'Anatomy of the organisation: recursive, cybernetic structure.'<span class="s2">, f2.x - </span><span class="s5">620</span><span class="s2">, f2.y + </span><span class="s5">260</span><span class="s2">, </span><span class="s5">1100</span><span class="s2">, COL.vsm, </span><span class="s5">22</span><span class="s2">);</span></p>
<p class="p6"><br></p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">        </span></span>// Connect context → VSM (feedforward)</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">await</span> connect(capitals, s4, COL.capability);</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">await</span> connect(env, s4, COL.capability);</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">await</span> connect(fiveCs, s3, COL.capability);</p>
<p class="p6"><br></p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">        </span></span>// ---- FRAME 3: Behavioural Dynamics (PACE2)</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">const</span> f3 = <span class="s1">await</span> createFrame(f2.x + FRAME_W/<span class="s5">2</span> + GAP_X + FRAME_W/<span class="s5">2</span>, y, <span class="s4">'FRAME 3 – Behavioural Dynamics (PACE2: 16 Conditions &amp; Failure Modes)'</span>, COL.pace);</p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">const</span><span class="s2"> paceGrid = </span><span class="s1">await</span><span class="s2"> createShape(</span>'PACE2 Grid\nPurpose • Awareness • Coordination • Engagement\n(16 conditions &amp; failure modes)'<span class="s2">, f3.x - </span><span class="s5">250</span><span class="s2">, f3.y - </span><span class="s5">80</span><span class="s2">, </span><span class="s5">700</span><span class="s2">, </span><span class="s5">260</span><span class="s2">, </span>'#ecfdf5'<span class="s2">, COL.pace, </span><span class="s5">24</span><span class="s2">);</span></p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">const</span> agentClusters = <span class="s1">await</span> createShape(<span class="s4">'Agent Groups / Teams\n(behavioural parameters per PACE2)'</span>, f3.x + <span class="s5">360</span>, f3.y - <span class="s5">80</span>, <span class="s5">460</span>, <span class="s5">240</span>, <span class="s4">'#ecfdf5'</span>, COL.pace, <span class="s5">24</span>);</p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">await</span><span class="s2"> createText(</span>'Maps behavioural drift and alignment inside the VSM structure.'<span class="s2">, f3.x - </span><span class="s5">600</span><span class="s2">, f3.y + </span><span class="s5">260</span><span class="s2">, </span><span class="s5">1100</span><span class="s2">, COL.pace, </span><span class="s5">22</span><span class="s2">);</span></p>
<p class="p6"><br></p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">        </span></span>// VSM ↔ PACE2 (feedback)</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">await</span> connect(s2, paceGrid, <span class="s4">'#f59e0b'</span>); <span class="s7">// orange-ish (feedback)</span></p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">await</span> connect(s3, paceGrid, <span class="s4">'#f59e0b'</span>);</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">await</span> connect(paceGrid, s1, <span class="s4">'#f59e0b'</span>);</p>
<p class="p6"><br></p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">        </span></span>// ---- FRAME 4: Causal Logic (Swiss Cheese → Bow-Tie)</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">const</span> f4 = <span class="s1">await</span> createFrame(f3.x + FRAME_W/<span class="s5">2</span> + GAP_X + FRAME_W/<span class="s5">2</span>, y, <span class="s4">'FRAME 4 – Causal Logic (Swiss Cheese → Bow-Tie + Sufficient Causes)'</span>, COL.causal);</p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">const</span><span class="s2"> swiss = </span><span class="s1">await</span><span class="s2"> createShape(</span>'Swiss Cheese (Defences)\nPolicy • Process • People • Technology\n(holes = latent weaknesses)'<span class="s2">, f4.x - </span><span class="s5">440</span><span class="s2">, f4.y - </span><span class="s5">120</span><span class="s2">, </span><span class="s5">560</span><span class="s2">, </span><span class="s5">220</span><span class="s2">, </span>'#fee2e2'<span class="s2">, COL.causal, </span><span class="s5">24</span><span class="s2">);</span></p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">const</span> topEvent = <span class="s1">await</span> createShape(<span class="s4">'Top Event\n(Loss of Control)'</span>, f4.x + <span class="s5">10</span>, f4.y - <span class="s5">120</span>, <span class="s5">260</span>, <span class="s5">120</span>, <span class="s4">'#ffffff'</span>, COL.causal, <span class="s5">24</span>);</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">const</span> bowLeft = <span class="s1">await</span> createShape(<span class="s4">'Threats → Preventive Controls'</span>, f4.x - <span class="s5">260</span>, f4.y + <span class="s5">140</span>, <span class="s5">460</span>, <span class="s5">140</span>, <span class="s4">'#fee2e2'</span>, COL.causal, <span class="s5">24</span>);</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">const</span> bowRight = <span class="s1">await</span> createShape(<span class="s4">'Consequences → Mitigations'</span>, <span class="Apple-converted-space">  </span>f4.x + <span class="s5">260</span>, f4.y + <span class="s5">140</span>, <span class="s5">460</span>, <span class="s5">140</span>, <span class="s4">'#fee2e2'</span>, COL.causal, <span class="s5">24</span>);</p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">const</span><span class="s2"> inus = </span><span class="s1">await</span><span class="s2"> createText(</span>'Sufficient Cause Maps (INUS / Equifinality)\nA+B+C ⇒ Failure; D+E ⇒ Resilience'<span class="s2">, f4.x - </span><span class="s5">560</span><span class="s2">, f4.y + </span><span class="s5">300</span><span class="s2">, </span><span class="s5">1200</span><span class="s2">, COL.causal, </span><span class="s5">22</span><span class="s2">);</span></p>
<p class="p6"><br></p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">await</span> connect(paceGrid, swiss, COL.causal);</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">await</span> connect(swiss, topEvent, COL.causal);</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">await</span> connect(topEvent, bowLeft, COL.causal);</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">await</span> connect(topEvent, bowRight, COL.causal);</p>
<p class="p6"><br></p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">        </span></span>// ---- FRAME 5: Adaptive Learning &amp; Development</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">const</span> f5 = <span class="s1">await</span> createFrame(f4.x + FRAME_W/<span class="s5">2</span> + GAP_X + FRAME_W/<span class="s5">2</span>, y, <span class="s4">'FRAME 5 – Adaptive Learning &amp; Development (Dynamic Capabilities + PACE Learning)'</span>, COL.learning);</p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">const</span><span class="s2"> dyn = </span><span class="s1">await</span><span class="s2"> createShape(</span>'Dynamic Capability Cycle\nAnticipate → Absorb → Assimilate → Adapt'<span class="s2">, f5.x - </span><span class="s5">300</span><span class="s2">, f5.y - </span><span class="s5">120</span><span class="s2">, </span><span class="s5">600</span><span class="s2">, </span><span class="s5">180</span><span class="s2">, </span>'#ede9fe'<span class="s2">, COL.learning, </span><span class="s5">24</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">const</span><span class="s2"> learn = </span><span class="s1">await</span><span class="s2"> createShape(</span>'Leadership Learning Loop\nReflection → Experimentation → Application → Integration'<span class="s2">, f5.x - </span><span class="s5">300</span><span class="s2">, f5.y + </span><span class="s5">80</span><span class="s2">, </span><span class="s5">600</span><span class="s2">, </span><span class="s5">180</span><span class="s2">, </span>'#ede9fe'<span class="s2">, COL.learning, </span><span class="s5">24</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">const</span><span class="s2"> dash = </span><span class="s1">await</span><span class="s2"> createShape(</span>'Resilience Dashboard (5Cs)\nCharacteristics • Capability • Capacity • Connectivity • Consequences'<span class="s2">, f5.x + </span><span class="s5">420</span><span class="s2">, f5.y - </span><span class="s5">40</span><span class="s2">, </span><span class="s5">520</span><span class="s2">, </span><span class="s5">220</span><span class="s2">, </span>'#ede9fe'<span class="s2">, COL.learning, </span><span class="s5">24</span><span class="s2">);</span></p>
<p class="p6"><br></p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">await</span> connect(bowRight, dyn, COL.capability);</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">await</span> connect(dyn, learn, COL.capability);</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">await</span> connect(learn, dash, COL.capability);</p>
<p class="p6"><br></p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">        </span></span>// Close the loop back to Environment</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">await</span> connect(dash, env, <span class="s4">'#f59e0b'</span>);</p>
<p class="p6"><br></p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">        </span></span>// Tagline</p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">await</span><span class="s2"> createText(</span>'“When holes align, failure happens. When barriers align, resilience happens.”'<span class="s2">,</span></p>
<p class="p3"><span class="Apple-converted-space">          </span>f3.x - <span class="s5">500</span>, f3.y + FRAME_H/<span class="s5">2</span> + <span class="s5">220</span>, <span class="s5">1600</span>, COL.text, <span class="s5">26</span>);</p>
<p class="p6"><br></p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">        </span></span>// Select new items so user can group them</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">const</span> created = <span class="s1">await</span> miro.board.getSelection();</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">await</span> miro.board.selection.selectWidgets([]); <span class="s7">// clear</span></p>
<p class="p3"><span class="Apple-converted-space">      </span>}</p>
<p class="p6"><br></p>
<p class="p3"><span class="Apple-converted-space">      </span><span class="s1">async</span> <span class="s1">function</span> groupAll() {</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">const</span> items = <span class="s1">await</span> miro.board.get({ <span class="s3">type</span>: [<span class="s4">'frame'</span>,<span class="s4">'shape'</span>,<span class="s4">'text'</span>,<span class="s4">'connector'</span>] });</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">await</span> miro.board.selection.selectWidgets(items.map(i =&gt; i.id));</p>
<p class="p3"><span class="Apple-converted-space">      </span>}</p>
<p class="p6"><br></p>
<p class="p3"><span class="Apple-converted-space">      </span>document.getElementById(<span class="s4">'build'</span>).addEventListener(<span class="s4">'click'</span>, async () =&gt; {</p>
<p class="p3"><span class="Apple-converted-space">        </span><span class="s1">try</span> {</p>
<p class="p3"><span class="Apple-converted-space">          </span><span class="s1">await</span> miro.board.ui.on(<span class="s4">'icon:click'</span>, () =&gt; {}); <span class="s7">// noop to ensure context</span></p>
<p class="p3"><span class="Apple-converted-space">          </span><span class="s1">await</span> build();</p>
<p class="p3"><span class="Apple-converted-space">        </span>} <span class="s1">catch</span> (e) {</p>
<p class="p3"><span class="Apple-converted-space">          </span>alert(<span class="s4">'Error building canvas: '</span> + e.message);</p>
<p class="p3"><span class="Apple-converted-space">        </span>}</p>
<p class="p3"><span class="Apple-converted-space">      </span>});</p>
<p class="p6"><br></p>
<p class="p3"><span class="Apple-converted-space">      </span>document.getElementById(<span class="s4">'clean'</span>).addEventListener(<span class="s4">'click'</span>, groupAll);</p>
<p class="p2"><span class="s2"><span class="Apple-converted-space">    </span></span>&lt;/script&gt;</p>
<p class="p2"><span class="s2"><span class="Apple-converted-space">  </span></span>&lt;/body&gt;</p>
<p class="p2">&lt;/html&gt;</p>
</body>
</html>
